# Backend Helm Chart Values Schema
# File: helm/backend/values.yaml
#
# This document defines the expected structure and defaults for the backend
# Helm chart values.yaml file.
#
# IMPORTANT: Actual secret values should be in values-local.yaml (gitignored)

# ============================================================================
# Image Configuration
# ============================================================================
image:
  repository: todo-backend     # Docker image name
  tag: "1.0.0"                 # Image tag (explicit, no 'latest')
  pullPolicy: IfNotPresent     # IfNotPresent for local images

# ============================================================================
# Replica Configuration
# ============================================================================
replicaCount: 1                # Number of pod replicas (1-3 typical)

# ============================================================================
# Service Configuration
# ============================================================================
service:
  type: ClusterIP              # ClusterIP for internal access only
  port: 8000                   # Service port
  targetPort: 8000             # Container port

# ============================================================================
# Resource Limits
# ============================================================================
resources:
  requests:
    cpu: 100m                  # Minimum CPU (100 millicores)
    memory: 256Mi              # Minimum memory (256 MiB)
  limits:
    cpu: 500m                  # Maximum CPU (500 millicores)
    memory: 512Mi              # Maximum memory (512 MiB)

# ============================================================================
# Environment Variables (Non-Sensitive)
# ============================================================================
env:
  PORT: "8000"
  # FRONTEND_URL set via ConfigMap

# ============================================================================
# ConfigMap Data (Non-Sensitive)
# ============================================================================
config:
  FRONTEND_URL: "http://todo-frontend:3000"

# ============================================================================
# Secrets (Sensitive - Override in values-local.yaml)
# ============================================================================
# DO NOT put actual values here - use values-local.yaml (gitignored)
secrets:
  databaseUrl: ""              # Neon PostgreSQL connection string
  geminiApiKey: ""             # Gemini AI API key
  betterAuthSecret: ""         # JWT signing secret

# ============================================================================
# Probes
# ============================================================================
livenessProbe:
  enabled: true
  path: /health
  port: 8000
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  enabled: true
  path: /health
  port: 8000
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

# ============================================================================
# Pod Configuration
# ============================================================================
podAnnotations: {}

podSecurityContext: {}

securityContext: {}

# ============================================================================
# Service Account (optional)
# ============================================================================
serviceAccount:
  create: false
  name: ""

# ============================================================================
# Node Selection (optional)
# ============================================================================
nodeSelector: {}

tolerations: []

affinity: {}

# ============================================================================
# Example values-local.yaml (DO NOT COMMIT)
# ============================================================================
# Create helm/backend/values-local.yaml with:
#
# secrets:
#   databaseUrl: "postgresql://user:pass@host/db?sslmode=require"
#   geminiApiKey: "your-gemini-api-key"
#   betterAuthSecret: "your-jwt-secret-from-frontend"
#
# Then deploy with:
# helm install backend ./helm/backend -f ./helm/backend/values-local.yaml
